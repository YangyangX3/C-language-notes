---
title: 变量基础
tags: [C语言, 变量, 数据类型, int, float, double, 变量定义, 变量初始化, 标识符, scanf, 输入输出]
---

# 2.1 变量基础

程序的核心是处理数据。为了在程序运行过程中存储和操作数据，我们需要使用变量。

## 什么是变量

-   **数据容器**: 变量就像一个带标签的盒子，用于在内存中保存数据。程序可以通过变量名来访问和修改存储在里面的值。
-   **存储变化的值**: 与常量不同，变量的值可以在程序执行过程中改变。
-   **解决动态问题**: 例如，在找零钱的程序中，如果每次付款金额都写死在代码里（如 `100 - 23`），那么每次金额变化都需要修改代码并重新编译。使用变量，我们可以让程序在运行时接收用户输入的金额，然后进行计算，更加灵活。

## 如何定义变量

在C语言中，使用变量前必须先**定义**它，明确变量的**类型**和**名称**。

-   **基本语法**:
    ```c
    <类型名称> <变量名称>;
    ```
-   **示例**:
    ```c
    int price;    // 定义一个名为 price 的整型变量
    int amount;   // 定义一个名为 amount 的整型变量
    int price, amount; // 在一行中定义多个同类型的变量，用逗号隔开
    ```
-   **变量类型 (Type)**:
    -   C是一种**强类型**语言，每个变量都有固定的类型，在定义时指定，之后不能改变。
    -   类型决定了变量能存储什么样的数据（如整数、小数）以及能进行哪些运算。
    -   `int`: 用于存储整数 (integer)。是我们目前接触最多的类型。
    -   `float`, `double`: 用于存储带小数点的数（浮点数）。`double` 通常比 `float` 精度更高，表示范围更大。
-   **变量名称 (Identifier)**:
    -   变量名也称为**标识符**。
    -   **命名规则**:
        1.  只能包含字母（`a-z`, `A-Z`）、数字（`0-9`）和下划线（`_`）。
        2.  第一个字符不能是数字。
        3.  不能是C语言的**关键字**（保留字，如 `int`, `void`, `return`, `if`, `while` 等）。
        4.  C语言区分大小写（`price` 和 `Price` 是两个不同的变量）。
    -   **选择有意义的名字**: 变量名应能反映其存储数据的含义，提高代码可读性（如用 `price` 而不是 `p`）。
    -   **关键字列表**: (不需要刻意记忆，编译器会报错，且用多了自然会熟悉)
        ```
        auto break case char const continue default do double else enum extern float for goto if int long register return short signed sizeof static struct switch typedef union unsigned void volatile while
        ```
        (C99/C11 还增加了 `_Bool`, `_Complex`, `_Imaginary`, `inline`, `restrict`, `_Alignas`, `_Alignof`, `_Atomic`, `_Generic`, `_Noreturn`, `_Static_assert`, `_Thread_local` 等)

## 变量的初始化与赋值

-   **初始化 (Initialization)**: 在定义变量的同时给它赋一个初始值。
    ```c
    int price = 0;         // 定义整型变量 price 并初始化为 0
    int amount = 100;      // 定义整型变量 amount 并初始化为 100
    int price = 0, amount = 100; // 同时定义并初始化多个变量
    // 错误示范: 不能用一个值同时初始化多个变量
    // int price, amount = 100; // 只有 amount 被初始化为 100，price 未初始化
    ```
-   **赋值 (Assignment)**: 在变量定义之后，通过赋值运算符 `=` 给变量设置新的值。
    ```c
    int price;    // 定义变量
    price = 100;  // 给变量 price 赋值为 100
    price = 50;   // 变量的值可以改变，现在 price 的值是 50
    ```
-   **赋值运算符 `=`**:
    -   **重要**: 在C语言（及很多编程语言）中，单个等号 `=` 表示**赋值**，是一个**动作**，意为"将右边的值赋给左边的变量"。
    -   它**不等于**数学中的等于关系。数学上 `a = b` 和 `b = a` 等价，但在程序中 `a = b;` 和 `b = a;` 是两个完全不同的赋值动作。
    -   `a = b;` // 把变量 `b` 的当前值赋给变量 `a`。
    -   `b = a;` // 把变量 `a` 的当前值赋给变量 `b`。
-   **未初始化的风险**:
    -   如果在定义变量时没有初始化，并且在使用它之前（特指在赋值号右边使用）没有给它赋过值，那么这个变量的值将是**未定义的**（通常是内存中遗留的随机"[^1]垃圾"值）。
    -   使用未初始化的变量可能导致程序运行结果错误或不可预测。
    ```c
    int i;
    int j;
    j = i + 10; // 错误！变量 i 在使用前没有被初始化或赋值
    printf("%d\n", j); // 输出结果将是不可预测的
    ```
    -   **最佳实践**: 养成定义变量时进行初始化的好习惯，即使只是初始化为 0。

## 读取用户输入 (`scanf`)

为了让程序更具交互性，我们可以使用 `scanf` 函数从键盘读取用户输入的值，并存入变量。

-   **基本用法**:
    ```c
    scanf("<格式字符串>", &<变量名>);
    ```
-   **示例**:
    ```c
    int price = 0;
    printf("请输入金额（元）: ");
    scanf("%d", &price); // 读取用户输入的整数，并存入 price 变量
    printf("你输入了 %d 元。\n", price);
    ```
-   **关键点**:
    -   `<格式字符串>`: 告诉 `scanf` 期望读取什么类型的数据。`%d` 表示期望读取一个十进制整数。
    -   `&<变量名>`: **极其重要**！在变量名前必须加上取地址符 `&`。它告诉 `scanf` 把读取到的值存放到变量 `price` 在内存中的地址去。（具体原理将在指针章节讲解，现在只需记住必须加 `&`）。
    -   **输入与回车**: 程序运行到 `scanf` 时会暂停，等待用户在控制台输入数据。用户输入完毕后需要按**回车键 (Enter)**，`scanf` 才会真正读取输入并继续执行。
-   **读取非数字输入**: 如果 `scanf` 期望读取数字 (`%d`)，但用户输入了非数字字符（如 "hello"），`scanf` 会读取失败。此时，变量的值通常不会被改变（保持其原有值，例如初始化时的 0），程序会继续执行。更健壮的输入处理需要更复杂的技巧，我们后续会学习。

## 整数与浮点数

-   **整数 (`int`)**: 只能存储没有小数部分的数值。
-   **浮点数 (`float`, `double`)**: 可以存储带小数点的数值。`double` 提供双精度，通常是更常用的浮点类型。
-   **整数运算的截断**: 当两个整数进行除法运算时，结果的小数部分会被直接丢弃（截断），只保留整数部分。
    ```c
    int a = 10;
    int b = 3;
    int c = a / b; // c 的结果是 3，而不是 3.333...
    printf("10 / 3 = %d\n", c); // 输出 3
    ```
-   **使用浮点数进行精确计算**: 如果需要保留小数部分，参与运算的数中至少要有一个是浮点数，并且结果变量也应该是浮点类型。
    ```c
    double a = 10.0; // 使用 10.0 而不是 10，使其成为 double 类型
    int b = 3;
    double c = a / b; // c 的结果将是 3.33333...
    printf("10.0 / 3 = %f\n", c); // 使用 %f 输出浮点数
    ```
    或者进行类型转换：
    ```c
    int a = 10;
    int b = 3;
    double c = (double)a / b; // 将 a 临时转换为 double 再进行除法
    printf("(double)10 / 3 = %f\n", c);
    ```

[^1]: C语言为了运行的效率在运行结束时是不会清除内存当中的值的，这就使得定义变量时分配给变量的内存地址可能存着上一个使用该内存地址的变量的值
