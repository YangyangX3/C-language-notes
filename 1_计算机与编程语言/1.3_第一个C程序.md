---
title: 第一个C程序：编写、编译、运行与输出
tags:
  - C语言
  - 编程入门
  - DevC++
related_code: "[[格式化输入输出.c]]"
---

# 第一个C程序：编写、编译、运行与输出

学习任何编程语言通常都是从编写一个能输出 "Hello, World!" 的程序开始的。C语言也不例外。这个过程涉及到编写代码、编译代码以及运行程序。

## C程序基本框架

一个最简单的C程序通常包含以下基本结构：

```c
#include <stdio.h> // 引入标准输入输出头文件

int main(void) // 程序的主入口函数
{
    // 你的代码将放在这里

    printf("Hello, World!\n"); // 打印输出 "Hello, World!" 到控制台

    return 0; // 表示程序正常结束
}
```

-   `#include <stdio.h>`：这是一个预处理指令，它告诉编译器把标准输入输出库（Standard Input/Output Library）包含进来。这个库提供了我们后面会用到的 `printf`（打印输出）和 `scanf`（读取输入）等函数。

-   `int main(void)`：这是主函数，是C程序的入口点。程序从 `main` 函数开始执行。`int` 表示这个函数执行完毕后会返回一个整数值，`void` 表示这个函数不接受任何参数。
-   `{ ... }`：花括号包围的部分是函数体，包含了函数要执行的语句。

-   `printf("Hello, World!\n");`：这是调用 `printf` 函数来在屏幕上显示文本。双引号内的内容是要显示的字符串。`\n` 是一个特殊的转义字符，表示换行。

-   `return 0;`：这表示 `main` 函数执行完毕，并向操作系统返回一个值 0。通常，返回 0 表示程序成功执行。
-   **注意**：C语言中，大部分语句（除了预处理指令、函数头等）都需要以分号 `;` 结尾。

## 编写、编译与运行

### 1. 编写代码

你可以使用任何文本编辑器来编写C代码，例如：

-   **简单的文本编辑器**: 如 Windows 的记事本、macOS 的文本编辑、Sublime Text、VS Code、Vim 等。
-   **集成开发环境 (IDE)**: 如 Dev-C++、Xcode (macOS)、Visual Studio (Windows) 等。IDE 通常集成了代码编辑、编译、调试等功能，对初学者更友好。

我们以 `Dev-C++` (推荐 5.6.3 或更新版本) 为例，步骤如下：
1.  打开 Dev-C++。
2.  文件 -> 新建 -> 源代码 (Ctrl+N)。
3.  在打开的编辑窗口输入或粘贴你的C代码。
4.  文件 -> 保存 (Ctrl+S)。选择保存类型为 `C source files (*.c)`，并命名文件，例如 `hello.c`。

### 2. 编译代码

编译是将人类可读的C源代码 (`.c` 文件) 转换成机器可以执行的二进制代码的过程。

-   **在 Dev-C++ 中**:
    -   点击菜单栏 "运行" -> "编译" (快捷键 F9)。
    -   或者直接点击工具栏上的编译按钮。
    -   编译结果会显示在下方的 "编译日志" 窗口。如果看到 "错误: 0, 警告: 0"，说明编译成功。编译成功后会在源文件目录下生成一个可执行文件（通常是 `.exe` 文件，如 `hello.exe`）。
-   **在 macOS/Linux 命令行中**:
    -   打开 "终端" (Terminal)。
    -   使用 `cd` 命令切换到你保存 `.c` 文件的目录。
    -   使用 `gcc` (GNU Compiler Collection) 命令进行编译：
        ```bash
        gcc hello.c
        ```
        这会默认生成一个名为 `a.out` 的可执行文件。
    -   如果你想指定输出的可执行文件名（例如 `hello`）：
        ```bash
        gcc hello.c -o hello
        ```

### 3. 运行程序

运行就是执行编译后生成的可执行文件。

-   **在 Dev-C++ 中**:
    -   点击菜单栏 "运行" -> "运行" (快捷键 F10)。
    -   或者直接点击工具栏上的运行按钮。
    -   如果之前没有编译，也可以直接点击 "编译运行" (快捷键 F11)。
    -   程序会在一个弹出的黑色窗口（称为控制台或终端）中运行，并显示输出结果。运行结束后通常会提示 "请按任意键继续..."。
-   **在 macOS/Linux 命令行中**:
    -   如果可执行文件是 `a.out`：
        ```bash
        ./a.out
        ```
    -   如果可执行文件是 `hello`：
        ```bash
        ./hello
        ```
    -   **注意**：前面的 `./` 是必需的，它告诉系统在当前目录下查找并执行该文件。

## 使用 `printf` 输出信息

`printf` 函数非常强大，不仅能输出固定文本，还能格式化输出变量和计算结果。

### 输出固定文本

如前所示，双引号内的内容会原样输出。`\n` 用于换行。

```c
printf("这是第一行。\n这是第二行。\n");
```

### 输出计算结果

我们可以使用**格式说明符**（Format Specifier）来指定输出数据的类型和格式。最常用的是 `%d`，用于输出十进制整数。

```c
#include <stdio.h>

int main(void)
{
    printf("12 + 34 = %d\n", 12 + 34); // %d 会被后面 12+34 的计算结果替换
    printf("10 * 5 = %d\n", 10 * 5);   // 乘法
    printf("100 / 5 = %d\n", 100 / 5); // 除法
    printf("10 %% 3 = %d\n", 10 % 3);  // 取余数 (注意要写 %% 来输出一个 % 符号)
    return 0;
}
```

运行结果:
```
12 + 34 = 46
10 * 5 = 50
100 / 5 = 20
10 % 3 = 1
```



`printf` 的格式说明符还有很多，可以控制输出的宽度、精度、对齐方式等。详细示例请参考：![[格式化输入输出.c]]

以下是一些来自该文件的例子：

```c
#include <stdio.h>

int main(void)
{
    // %9d: 输出整数，至少占9位，默认右对齐
    printf("右对齐，宽度9: |%9d|\n", 123);

    // %-9d: 输出整数，至少占9位，左对齐
    printf("左对齐，宽度9: |%-9d|\n", 123);

    // %09d: 输出整数，至少占9位，不足部分用0填充
    printf("补零，宽度9: |%09d|\n", 123);

    // %9.2f: 输出浮点数，总宽度9，小数点后保留2位
    printf("浮点数，宽9点后2位: |%9.2f|\n", 123.0);

    // %*d: 输出整数，宽度由后续参数指定 (这里是6)
    printf("动态宽度6: |%*d|\n", 6, 123);

    // %hhd: 输出一个字符对应的整数值 (需要强制类型转换)
    printf("字符转整数(12345截断): %hhd\n", (char)12345); // 12345 超出 char 范围会被截断

    return 0;
}
```
运行结果：
```
右对齐，宽度9: |      123|
左对齐，宽度9: |123      |
补零，宽度9: |000000123|
浮点数，宽9点后2位: |   123.00|
动态宽度6: |   123|
字符转整数(12345截断): 57
```

## 使用 `scanf` 读取输入

与 `printf` 对应，`scanf` 用于从键盘读取用户输入。它也使用格式说明符来指定要读取的数据类型。

```c
#include <stdio.h>

int main(void)
{
    int num;
    printf("请输入一个整数: ");
    scanf("%d", &num); // 读取一个整数，并存入变量 num 中
                      // 注意 num 前面的 '&' 符号，表示取变量地址，必须要有！
    printf("你输入的整数是: %d\n", num);

    // 演示 scanf 的一些特性 (来自 格式化输入输出.c)
    printf("输入两个整数 (第一个会被忽略): ");
    scanf("%*d%d", &num); // %*d 表示读取一个整数但不保存
    printf("第二个整数是: %d\n", num);

    printf("输入一个整数 (可以是八/十六进制如010或0x10): ");
    scanf("%i", &num); // %i 可以自动识别八进制/十六进制前缀
    printf("你输入的整数是 (十进制): %d\n", num);

    char str[10];
    printf("输入一串数字 (最多9位): ");
    // " %..." 前面的空格可以跳过输入缓冲区中的空白符（如换行符）
    // %[0-9] 只读取数字字符
    scanf(" %[0-9]", str);
    printf("你输入的数字字符串是: %s\n", str);

    return 0;
}
```

**重要**: 使用 `scanf` 读取变量时，变量名前通常需要加上取地址符 `&`。读取字符串数组时则不需要（数组名本身就代表地址）。

## `printf` 和 `scanf` 的返回值

-   `printf` 返回成功打印的字符数。
-   `scanf` 返回成功读取并赋值的变量个数。如果输入不匹配或遇到文件结尾，可能返回 0 或 EOF (-1)。

```c
#include <stdio.h>

int main(void)
{
    int num;
    int i1, i2;

    printf("输入一个整数: ");
    i1 = scanf("%i", &num);  // i1 会是成功读取的数量 (通常是1)
    i2 = printf("读取的数是: %i\n", num); // i2 是这行打印的字符数
    printf("scanf返回值: %d, printf返回值: %d\n", i1, i2);

    return 0;
}
```

## 常见错误与注意事项

1.  **忘记分号 `;`**: C语言中大多数语句以分号结尾。如果忘记写，编译器通常会在**下一行**或附近报错，提示信息可能是 "expected ';' before..."。
2.  **中英文标点符号混用**: 程序代码中所有的标点符号（如 `( ) { } [ ] ; : ' " , .`）都必须使用**英文半角**字符。使用中文全角标点会导致编译错误，错误信息可能看起来很奇怪，因为它不认识这些字符。
    ```c
    // 错误示例：使用了中文分号
    // printf("Hello")； // 编译失败！
    ```
    **强烈建议**：编写代码时关闭中文输入法。
3.  **括号不匹配**: 各种括号 `()`、`{}`、`[]` 必须成对出现。IDE 通常会自动补全或高亮匹配的括号，有助于减少此类错误。
4.  **`printf` 格式说明符与参数不匹配**: `%d` 对应整数，`%f` 对应浮点数等。类型或数量不匹配可能导致输出错误或程序崩溃。
5.  **`scanf` 忘记加 `&`**: 读取基本类型变量（如 `int`, `float`, `char`）时，变量名前必须加 `&` 取地址符。忘记加会导致程序运行时错误（通常是崩溃）。
6.  **编译器错误信息**: 有时编译器报告的错误位置不一定就是真正出错的那一行，可能需要检查上一行或附近的代码。多看编译器的提示信息，尝试理解它的意图。

## 总结

编写第一个C程序的基本流程是：
1.  **编写**: 使用编辑器或IDE写入包含 `main` 函数和 `#include <stdio.h>` 的代码。
2.  **编译**: 使用编译器 (如 `gcc` 或 IDE 内置编译器) 将 `.c` 文件转换为可执行文件。检查并修复编译错误。
3.  **运行**: 执行生成的可执行文件，在控制台查看 `printf` 输出的结果，或通过 `scanf` 与程序交互。
4.  **调试**: 如果程序运行不符合预期或出现错误，回顾代码逻辑，利用编译器的警告信息，或使用调试工具来查找问题。

熟悉这个流程是学习C语言的第一步。多练习，多尝试修改代码并观察结果，可以帮助你更快地掌握基础知识。