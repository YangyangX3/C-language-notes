---
title: 水仙花数
tags:
  - C语言
  - 编程练习
  - 循环
  - 数学问题
  - 数字分解
  - 幂运算
  - 水仙花数
  - Armstrong数
related_code: "[[水仙花.c]]"
---

# 6.2 水仙花数 (Narcissistic Number)

## 问题描述

水仙花数（也称阿姆斯特朗数）是指一个 n 位正整数 (n ≥ 3)，其各位数字的 n 次幂之和等于它本身。
例如：153 是一个 3 位数，且 1³ + 5³ + 3³ = 1 + 125 + 27 = 153。

要求编写程序，输入一个整数 n (3 ≤ n ≤ 7)，输出所有 n 位的水仙花数，每个数占一行。

**输入样例：**
```
3
```

**输出样例：**
```
153
370
371
407
```

## 解题思路

1.  **输入**: 读取位数 `n`。
2.  **确定范围**: 找出所有 n 位数的范围。
    *   最小值是 10<sup>n-1</sup>。
    *   最大值是 10<sup>n</sup> - 1。
    *   可以通过循环计算出最小值 `frist = 10^(n-1)`。
3.  **遍历**: 使用一个循环遍历从 `frist` 到 `frist * 10 - 1` (或 `< frist * 10`) 的所有 n 位数 `i`。
4.  **计算幂和**: 对于当前的数字 `i`，需要计算其各位数字的 n 次幂之和。
    *   创建一个临时变量 `t = i`，用于分解数字而不破坏原始的 `i`。
    *   创建一个变量 `sum = 0`，用于累加幂和。
    *   使用另一个循环（如 `do-while` 或 `while`）来处理 `t`：
        *   **取个位**: `d = t % 10`。
        *   **计算 n 次幂**: 计算 `d` 的 n 次方。这需要再内嵌一个循环，将 `d` 自身乘以 `n` 次（或初始化为 d，再乘 n-1 次）。设结果为 `s`。
        *   **累加**: `sum += s`。
        *   **移除个位**: `t /= 10`。
        *   循环直到 `t` 变为 0。
5.  **判断**: 比较计算得到的 `sum` 和原始数字 `i`。
    *   如果 `sum == i`，则 `i` 是一个水仙花数，输出 `i`。
6.  **循环继续**: 继续外层循环，检查下一个 n 位数。

## 核心逻辑

```c
// 核心逻辑伪代码
read n
frist = 1
// 计算 n 位数的起始值 (10^(n-1))
for count from 1 to n-1:
  frist = frist * 10

// 遍历所有 n 位数 i
for i from frist to frist * 10 - 1:
  t = i
  sum = 0
  // 分解数字 t，计算幂和
  while t > 0:
    d = t % 10
    // 计算 d 的 n 次方，存入 s
    s = 1
    for count from 1 to n:
      s = s * d
    sum = sum + s
    t = t / 10
  // 判断是否为水仙花数
  if sum == i:
    print i
```

## 代码示例

相关代码：[[水仙花.c]]

```c
#include <stdio.h>
#include <math.h> // pow 函数虽然可用，但题目环境可能限制，或手动循环计算幂更符合练习目的

int main()
{
	int n;
	// 读取用户输入的n值（3-7位数）
	scanf("%d", &n);
	// 验证 n 的范围 (可选，但良好实践)
	if (n >= 3 && n <= 7)
	{
		int i = 1;
		long long frist = 1; // 使用 long long 防止 frist * 10 溢出
		// 计算起始值 10^(n-1)
		while (i < n) {
			frist *= 10;
			i++;
        }

		// 遍历所有 n 位数，注意上限
		for (long long num = frist; num < frist * 10; num++) // 循环变量也用 long long
		{
			long long t = num; // 临时变量用于分解
			long long sum = 0; // 累加幂和，也用 long long 防止溢出

			// 计算各位数字的 n 次方和
			while (t > 0) // 使用 while 循环分解
			{
				int d = t % 10; // 取个位数字
				long long s = 1; // 存储 d 的 n 次方，用 long long
				int cnt = n;    // 计数器用于 n 次幂计算
				// 计算 d 的 n 次方
				while (cnt > 0) {
					s *= d;
                    // 处理 0 的 0 次方问题 (虽然此场景下 n>=3 不会遇到 0^0)
                    // 但更健壮的幂计算应考虑 d=0 且 n=0 的情况（虽然这里不需要）
					cnt--;
                }
				sum += s; // 累加到总和
                // 在累加过程中检查是否已超限，可提前终止（优化，可选）
                if (sum > num) {
                    break;
                }
				t = t / 10; // 移除个位
			}

			// 输出符合条件的水仙花数
			if (sum == num) {
				printf("%lld\n", num); // 输出 long long
            }
		}
	} else {
        printf("输入的位数 n 不在 3 到 7 之间。\n");
    }
	return 0;
}
```

**注意**: 随着 `n` 增大，水仙花数会变得非常稀少，且数值可能很大，因此使用 `long long` 类型来存储数字本身、起始值和幂和是必要的，以防止整数溢出。